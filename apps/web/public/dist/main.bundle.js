"use strict";(self.webpackChunktest_project=self.webpackChunktest_project||[]).push([[179],{884:()=>{function e(e,t){t.otherwise("/servers"),e.state({name:"servers",url:"/servers",component:"serversList"}).state({name:"servers.view",url:"/view/:id",component:"serversView"}).state({name:"servers.edit",url:"/edit/:id",component:"serversEdit"}).state({name:"servers.create",url:"/create",component:"serversEdit"}).state({name:"journals",url:"/journals",component:"journalsMain"}).state({name:"charts",url:"/charts",component:"chartsMain"})}e.$inject=["$stateProvider","$urlRouterProvider"];const t=angular.module("servers",[]).component("serversList",{templateUrl:"/partials/servers/list",controller:["Server","Task","NotificationService",function(e,t,r){this.servers=e.query(),this.addTasks=function(){confirm("Вы хотите добавить задания?")&&t.addRandom((function(){r.showSuccess("Задания добавленны")}))}}]}).component("serversEdit",{templateUrl:"/partials/servers/edit",controller:["Server","$stateParams","$state","NotificationService",function(e,t,r,s){t.id?this.server=e.get({id:t.id}):this.server=new e,this.save=function(){this.server.$save((function(){s.showSuccess("Сервер сохранен"),r.go("servers",{},{reload:!0})}))}}]}).component("serversView",{templateUrl:"/partials/servers/view",controller:["Server","$stateParams","NotificationService","Charts",function(e,t,r,s){this.server=e.get({id:t.id}),this.charts=s.serverCharts({serverId:t.id}),this.start=function(){confirm("Вы хотите запустить сервер?")&&this.server.$start((function(){r.showSuccess("Сервер запущен")}))},this.stop=function(){confirm("Вы хотите остановить сервер?")&&this.server.$stop((function(){r.showSuccess("Сервер остановлен")}))}}]}).directive("serverUserActionTable",["$compile","dataTableLanguage",function(e,t){return{restrict:"A",scope:{onDraw:"&",filter:"<",serverId:"<"},link:function(r,s){const a=s.DataTable({ordering:!1,searching:!0,processing:!0,serverSide:!0,language:t,ajax:"/journals/user-actions/"+r.serverId,columns:[{data:"date"},{data:"user"},{data:"action"}],order:[[0,"desc"]],createdRow:function(t,s){const a=r.$new(!0);a.data=s,e(angular.element(t).contents())(a)}});a.columns().every((function(){const e=this;$("input",this.header()).on("change",(function(){e.search()!==$(this).val()&&e.search($(this).val(),!1,!1).draw()})),$("select",this.header()).on("change",(function(){e.search()!==$(this).val()&&e.search($(this).val()).draw()}))})),a.on("draw",(function(){r.onDraw({params:a.ajax.params()})}))}}}]).directive("serverTasksTable",["$compile","dataTableLanguage",function(e,t){return{restrict:"A",scope:{onDraw:"&",filter:"<",serverId:"<"},link:function(r,s){const a=s.DataTable({ordering:!1,searching:!0,processing:!0,serverSide:!0,language:t,ajax:"/tasks/list/"+r.serverId,columns:[{data:"date"},{data:"name"},{data:"completeDuration"},{data:"isComplete",render:function(e,t,r){return r.isComplete?"Да":"Нет"}}],order:[[0,"desc"]],createdRow:function(t,s){const a=r.$new(!0);a.data=s,e(angular.element(t).contents())(a)}});a.columns().every((function(){const e=this;$("input",this.header()).on("change",(function(){e.search()!==$(this).val()&&e.search($(this).val(),!1,!1).draw()})),$("select",this.header()).on("change",(function(){e.search()!==$(this).val()&&e.search($(this).val()).draw()}))})),a.on("draw",(function(){r.onDraw({params:a.ajax.params()})}))}}}]).component("tasksChart",{templateUrl:"/partials/servers/default-chart",bindings:{report:"<"},controller:[function(){this.$onInit=function(){this.chartParams={type:"bar",data:{datasets:[{label:"Выполненные",data:this.report.complete,backgroundColor:this.report.complete.map((function(){return"#0000ff"}))},{label:"Невыполненные",data:this.report.notComplete,backgroundColor:this.report.notComplete.map((function(){return"#ff0000"}))}],labels:this.report.labels},options:{responsive:!0,legend:{display:!1,position:"left"},scales:{x:{stacked:!1,beginAtZero:!0},y:{stacked:!1,min:0}}}}}}]}),r=angular.module("factories",[]).factory("Server",["$resource",function(e){return e("/servers/:id",{id:"@_id"},{stop:{url:"/servers/:id/stop",method:"get",isArray:!1},start:{url:"/servers/:id/start",method:"get",isArray:!1}})}]).factory("Task",["$resource",function(e){return e("/tasks/:id",{id:"@_id"},{addRandom:{url:"/tasks/add-random",method:"get",isArray:!1}})}]).factory("Charts",["$resource",function(e){return e("/charts",{},{serverCharts:{url:"/charts/:serverId",method:"get",isArray:!1}})}]);angular.module("test_project",["ngResource","ui.bootstrap","ui.router",t.name,r.name]).config(e).service("NotificationService",class{showNotification(e,t){$.jGrowl(e,t)}showSuccess(e){this.showNotification(e,{header:"Выполнено",theme:"success",life:5e3})}showError(e){this.showNotification(e,{header:"Ошибка",theme:"error",life:2e4})}}).constant("dataTableLanguage",{info:"Показывается от _START_ до _END_ из _TOTAL_ записей",decimal:"",emptyTable:"Нет данных по таблице",infoEmpty:"Показывается от 0 до 0 из 0 записей",infoFiltered:"(Фильтрованно  из _MAX_ записей)",infoPostFix:"",thousands:",",lengthMenu:"Показывать _MENU_ записей",loadingRecords:"Загрузка...",processing:"Загрузка...",search:"Поиск:",zeroRecords:"Не найдено записей",paginate:{first:"Начало",last:"Конец",next:"Следующая",previous:"Предыдущая"},aria:{sortAscending:": activate to sort column ascending",sortDescending:": activate to sort column descending"}}).directive("chart",(function(){return{restrict:"A",scope:{params:"<"},link:function(e,t){this.chart=new Chart(t.get(0),e.params)}}}))}},e=>{e(e.s=884)}]);