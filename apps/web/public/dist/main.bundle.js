"use strict";(self.webpackChunktest_project=self.webpackChunktest_project||[]).push([[179],{731:()=>{function e(e,r){r.otherwise("/servers"),e.state({name:"servers",url:"/servers",component:"serversList"}).state({name:"servers.view",url:"/view/:id",component:"serversView"}).state({name:"servers.edit",url:"/edit/:id",component:"serversEdit"}).state({name:"servers.create",url:"/create",component:"serversEdit"}).state({name:"journals",url:"/journals",component:"journalsMain"}).state({name:"charts",url:"/charts",component:"chartsMain"}).state({name:"groups",url:"/groups",component:"groupsList"}).state({name:"groups.create",url:"/create",component:"groupsEdit"}).state({name:"groups.edit",url:"/edit/:id",component:"groupsEdit"}).state({name:"groups.view",url:"/view/:id",component:"groupsView"})}e.$inject=["$stateProvider","$urlRouterProvider"];const r=angular.module("servers",[]).component("serversList",{templateUrl:"/partials/servers/list",controller:["Server","Task","NotificationService",function(e,r,t){this.servers=e.query(),this.addTasks=function(){confirm("Вы хотите добавить задания?")&&r.addRandom((function(){t.showSuccess("Задания добавленны")}))}}]}).component("serversEdit",{templateUrl:"/partials/servers/edit",controller:["Server","Group","$stateParams","$state","NotificationService",function(e,r,t,s,a){t.id?this.server=e.get({id:t.id}):this.server=new e,this.groups=r.query(),this.save=function(){this.server.$save((function(){a.showSuccess("Сервер сохранен"),s.go("servers",{},{reload:!0})}))},this.delete=function(){confirm("Вы точно хотите удалить сервер ?")&&this.server.$delete((()=>{a.showSuccess("Сервер удален"),s.go("servers",{},{reload:!0})}))}}]}).component("serversView",{templateUrl:"/partials/servers/view",controller:["Server","$stateParams","NotificationService","Charts",function(e,r,t,s){this.server=e.get({id:r.id}),this.charts=s.serverCharts({serverId:r.id}),this.start=function(){confirm("Вы хотите запустить сервер?")&&this.server.$start((function(){t.showSuccess("Сервер запущен")}))},this.stop=function(){confirm("Вы хотите остановить сервер?")&&this.server.$stop((function(){t.showSuccess("Сервер остановлен")}))},this.restart=function(){confirm("Вы хотите перезапустить сервер?")&&this.server.$restart((function(){t.showSuccess("Сервер перезапущен")}))}}]}).directive("serverUserActionTable",["$compile","dataTableLanguage",function(e,r){return{restrict:"A",scope:{onDraw:"&",filter:"<",serverId:"<"},link:function(t,s){const a=s.DataTable({ordering:!1,searching:!0,processing:!0,serverSide:!0,language:r,ajax:"/journals/user-actions/"+t.serverId,columns:[{data:"date"},{data:"user"},{data:"action"}],order:[[0,"desc"]],createdRow:function(r,s){const a=t.$new(!0);a.data=s,e(angular.element(r).contents())(a)}});a.columns().every((function(){const e=this;$("input",this.header()).on("change",(function(){e.search()!==$(this).val()&&e.search($(this).val(),!1,!1).draw()})),$("select",this.header()).on("change",(function(){e.search()!==$(this).val()&&e.search($(this).val()).draw()}))})),a.on("draw",(function(){t.onDraw({params:a.ajax.params()})}))}}}]).directive("serverTasksTable",["$compile","dataTableLanguage",function(e,r){return{restrict:"A",scope:{onDraw:"&",filter:"<",serverId:"<"},link:function(t,s){const a=s.DataTable({ordering:!1,searching:!0,processing:!0,serverSide:!0,language:r,ajax:"/tasks/list/"+t.serverId,columns:[{data:"date"},{data:"name"},{data:"completeDuration"},{data:"isComplete",render:function(e,r,t){return t.isComplete?"Да":"Нет"}}],order:[[0,"desc"]],createdRow:function(r,s){const a=t.$new(!0);a.data=s,e(angular.element(r).contents())(a)}});a.columns().every((function(){const e=this;$("input",this.header()).on("change",(function(){e.search()!==$(this).val()&&e.search($(this).val(),!1,!1).draw()})),$("select",this.header()).on("change",(function(){e.search()!==$(this).val()&&e.search($(this).val()).draw()}))})),a.on("draw",(function(){t.onDraw({params:a.ajax.params()})}))}}}]).component("tasksChart",{templateUrl:"/partials/servers/default-chart",bindings:{report:"<"},controller:[function(){this.$onInit=function(){this.chartParams={type:"bar",data:{datasets:[{label:"Выполненные",data:this.report.complete,backgroundColor:this.report.complete.map((function(){return"#0000ff"}))},{label:"Невыполненные",data:this.report.notComplete,backgroundColor:this.report.notComplete.map((function(){return"#ff0000"}))}],labels:this.report.labels},options:{responsive:!0,legend:{display:!1,position:"left"},scales:{x:{stacked:!1,beginAtZero:!0},y:{stacked:!1,min:0}}}}}}]}),t=angular.module("groups",[]).component("groupsList",{templateUrl:"/partials/groups/list",controller:["Group",function(e){this.groups=e.query()}]}).component("groupsEdit",{templateUrl:"/partials/groups/edit",controller:["Group","NotificationService","$stateParams","$state",function(e,r,t,s){t.id?this.group=e.get({id:t.id}):this.group=new e,this.save=function(){this.group.$save((()=>{r.showSuccess("Группа сохранена"),s.go("groups",{},{reload:!0})}))}}]}).component("groupsView",{templateUrl:"/partials/groups/view",controller:["Group","Server","$stateParams",function(e,r,t){this.servers=r.groupServers({group_id:t.id}),this.group=e.get({id:t.id})}]}),s=angular.module("factories",[]).factory("Server",["$resource",function(e){return e("/servers/:id",{id:"@_id"},{stop:{url:"/servers/:id/stop",method:"get",isArray:!1},start:{url:"/servers/:id/start",method:"get",isArray:!1},restart:{url:"/servers/:id/restart",method:"get",isArray:!1},groupServers:{url:"/servers/group/:group_id",method:"get",isArray:!0}})}]).factory("Task",["$resource",function(e){return e("/tasks/:id",{id:"@_id"},{addRandom:{url:"/tasks/add-random",method:"get",isArray:!1}})}]).factory("Charts",["$resource",function(e){return e("/charts",{},{serverCharts:{url:"/charts/:serverId",method:"get",isArray:!1}})}]).factory("Group",["$resource",function(e){return e("/groups/:id",{id:"@_id"},{})}]);angular.module("test_project",["ngResource","ui.bootstrap","ui.router",r.name,t.name,s.name]).config(e).service("NotificationService",class{showNotification(e,r){$.jGrowl(e,r)}showSuccess(e){this.showNotification(e,{header:"Выполнено",theme:"success",life:5e3})}showError(e){this.showNotification(e,{header:"Ошибка",theme:"error",life:2e4})}}).constant("dataTableLanguage",{info:"Показывается от _START_ до _END_ из _TOTAL_ записей",decimal:"",emptyTable:"Нет данных по таблице",infoEmpty:"Показывается от 0 до 0 из 0 записей",infoFiltered:"(Фильтрованно  из _MAX_ записей)",infoPostFix:"",thousands:",",lengthMenu:"Показывать _MENU_ записей",loadingRecords:"Загрузка...",processing:"Загрузка...",search:"Поиск:",zeroRecords:"Не найдено записей",paginate:{first:"Начало",last:"Конец",next:"Следующая",previous:"Предыдущая"},aria:{sortAscending:": activate to sort column ascending",sortDescending:": activate to sort column descending"}}).directive("chart",(function(){return{restrict:"A",scope:{params:"<"},link:function(e,r){this.chart=new Chart(r.get(0),e.params)}}}))}},e=>{e(e.s=731)}]);